system:
  name: Token
  description: Managing and transacting with FIL tokens
  subsystems:
    - name: Payment Channels
      features:
        - name: Allocate Lane
          behaviors:
            - id: PAYCH_ALLOC_001
              description: Succeeds if channel address and lane number are valid
        - name: Payment Channel Best Spendable
          behaviors:
            - id: PAYCH_BEST_001
              description: Returns the best spendable voucher if channel address is valid
        - name: Payment Channel Collect
          behaviors:
            - id: PAYCH_COLLECT_001
              description: Transfers the ToPay amount to the recipient and the remaining
                change to the sender, if it's called either by the sender or
                recipient
            - id: PAYCH_COLLECT_002
              description: Fails if not signed by both parties
        - name: Payment Channel Create
          behaviors:
            - id: PAYCH_CREATE_001
              description: Succeeds if sender, recipient and amount are valid
            - id: PAYCH_CREATE_002
              description: Supports both ID and non-ID sender and recipient addresses
            - id: PAYCH_CREATE_003
              description: Fails if sender or recipient addresses are not resolvable to an ID
                address
        - name: Payment Channel List Vouchers
          behaviors:
            - id: PAYCH_LIST_001
              description: Returns a list of vouchers if channel address is valid
        - name: Payment Channel Settle
          behaviors:
            - id: PAYCH_SETTLE_001
              description: Succeeds if called by either the sender or recipient
            - id: PAYCH_SETTLE_002
              description: Fails if called twice
        - name: Payment Channel Status
          behaviors:
            - id: PAYCH_STATUS_001
              description: Returns  "Channel does not exist" if sender and recipient addresses
                don't have an open channel
            - id: PAYCH_STATUS_002
              description: Returns channel status, balance and a list of vouchers, if the
                channel was created
        - name: Voucher Create
          behaviors:
            - id: VOUCH_CREATE_001
              description: Succeeds if the channel address, nonce and amount are valid
            - id: VOUCH_CREATE_002
              description: Fails if voucher address does not match the channel address
            - id: VOUCH_CREATE_003
              description: Fails if creator balance < voucher amount
            - id: VOUCH_CREATE_004
              description: Fails if sum of voucher amounts > channel balance
            - id: VOUCH_CREATE_005
              description: Fails if voucher signature is invalid
            - id: VOUCH_CREATE_006
              description: Fails when signed by channel recipient instead of sender
            - id: VOUCH_CREATE_007
              description: Fails when nonce too low
        - name: Voucher Redeem
          behaviors:
            - id: VOUCH_REDEEM_001
              description: Succeeds, given a valid channel address, voucher and lane
            - id: VOUCH_REDEEM_002
              description: Fails on nonce reuse
            - id: VOUCH_REDEEM_004
              description: Fails if voucher balance < 0
            - id: VOUCH_REDEEM_005
              description: Fails if >12hrs since the channel was settled
            - id: VOUCH_REDEEM_006
              description: Succeds if <12hrs since the channel was settled
            - id: VOUCH_REDEEM_007
              description: Fails if current height < Voucher.TimeLock
            - id: VOUCH_REDEEM_008
              description: Fails if voucher signature is invalid
            - id: VOUCH_REDEEM_009
              description: Fails if current height >= Voucher.TimeLockMax
        - name: Payment Channel Get
          behaviors:
            - id: PAYMENT_CHANNEL_GET_001
              description: Gets channel information. It takes from and to addresses and amount
        - name: Payment Channel Wait Ready
          behaviors:
            - id: PAYMENT_CHANNEL_WAIT_READY_001
              description: waits until the create channel / add funds message with the given
                message CID arrives
        - name: Payment Channel Available Funds
          behaviors:
            - id: PAYMENT_CHANNEL_AVAILABLE_FUNDS_001
              description: Gets the total available funds currently in the channel, given the
                address
            - id: PAYMENT_CHANNEL_AVAILABLE_FUNDS_FROM_TO_001
              description: Gets the total available funds in the channel, given the address
                from and address to
            - id: PAYMENT_CHANNEL_AVAILABLE_FUNDS_FROM_TO_001
              description: If there is no active channel between from / to we still want to
                return an empty result object
        - name: Payment Channel List
          behaviors:
            - id: PAYMENT_CHANNEL_LIST_001
              description: List channels with given address
        - name: Payment Channel Voucher Valid
          behaviors:
            - id: PAYMENT_CHANNEL_VOUCHER_001
              description: Checks if vaucher is valid in case when voucher amount < balance
            - id: PAYMENT_CHANNEL_VOUCHER_002
              description: Checks if vaucher is valid and fails when funds are too low
            - id: PAYMENT_CHANNEL_VOUCHER_003
              description: Checks if vaucher is valid and fails when signature is invalid
            - id: PAYMENT_CHANNEL_VOUCHER_004
              description: Checks if vaucher is valid and fails when signed by channel To
                account (instead of From account)
            - id: PAYMENT_CHANNEL_VOUCHER_005
              description: Checks if vaucher is valid and fails when nonce is too low
            - id: PAYMENT_CHANNEL_VOUCHER_006
              description: Checks if vaucher is valid and passes when nonce is higher
            - id: PAYMENT_CHANNEL_VOUCHER_007
              description: Checks if vaucher is valid and passes when nonce for is different
                lane
            - id: PAYMENT_CHANNEL_VOUCHER_008
              description: Checks if vaucher is valid and fails when voucher has higher nonce
                but lower value than lane state
            - id: PAYMENT_CHANNEL_VOUCHER_009
              description: Checks if vaucher is valid and passes when voucher total redeemed
                <= balance
            - id: PAYMENT_CHANNEL_VOUCHER_010
              description: Checks if vaucher is valid and fails when voucher total redeemed >
                balance
    - name: Wallet
      features:
        - name: Wallet Balance
          behaviors:
            - id: WALLET_BALANCE_001
              description: Given a known address, returns the balance of the specified address
                at the current head of the chain
        - name: Wallet Default Address
          behaviors:
            - id: WALLET_DEFAULT_ADDRESS_001
              description: Returns the address marked as default in the wallet
        - name: Wallet Delete
          behaviors:
            - id: WALLET_DELETE_001
              description: Given a (local) address, delete the specified address from the
                wallet
        - name: Wallet Export
          behaviors:
            - id: WALLET_EXPORT_001
              description: Given a (local) address, return the private key of the specified
                address
        - name: Wallet Has
          behaviors:
            - id: WALLET_HAS_001
              description: Given an address, return true if the specified address is in the
                wallet
        - name: Wallet Import
          behaviors:
            - id: WALLET_IMPORT_001
              description: Given a private key, import it to the wallet and return the
                associated address
        - name: Wallet List
          behaviors:
            - id: WALLET_LIST_001
              description: Return a list of all addresses in the wallet
        - name: Wallet New
          behaviors:
            - id: WALLET_NEW_001
              description: "Creates and returns a new address with the given sigType, one of:
                bls, secp256k1, secp256k1-ledger"
        - name: Wallet Set Default
          behaviors:
            - id: WALLET_SET_DEFAULT_001
              description: Given a (local) address, mark it as the default
        - name: Wallet Sign
          behaviors:
            - id: WALLET_SIGN_001
              description: Given an (local) address and an array of bytes, return the
                signature of the specified bytes
        - name: Wallet Sign Message
          behaviors:
            - id: WALLET_SIGN_MESSAGE_001
              description: Given a (local) address and an unsigned message, sign and return a
                signed message
        - name: Wallet Validate Address
          behaviors:
            - id: WALLET_VALIDATE_ADDRESS_001
              description: Given a string, return the address if it can be decoded
        - name: Wallet Verify
          behaviors:
            - id: WALLET_VERIFY_001
              description: Given (any) address, a signature and some bytes, return true if the
                signature is valid for the specified address and input bytes