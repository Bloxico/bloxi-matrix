systems:    
  API:
    subsystems:
      Common:
        features:
          - name: API Version
            behaviors:
              - id: API_VERSION_001
                description: Returns the actual build version of the node
          - name: API Shutdown
            behaviors:
              - id: API_SHUTDOWN_001
                description: Trigger a graceful shutdown of the node
      Auth:
        features:
          - name: API Auth Verify
            behaviors:
              - id: API_AUTH_VERIFY_001
                description: Given a JWT token, verify the token and return a list of
                  permissions associated with the specified token
          - name: API Auth New
            behaviors:
              - id: API_AUTH_NEW_001
                description: Given a list of permissions, return a new JWT token with specified
                  permissions
  Repository:
    subsystems:
      File Store:
        features:
          - name: Create UnixFS Filestore
            behaviors:
              - id: CLIENT_FS_001
                description: Takes a standard file whose path is src, forms a UnixFS DAG, and
                  writes a CARv2 file with positional mapping
          - name: CARv2 to Normal File
            behaviors:
              - id: CLIENT_FS_002
                description: Opens the CAR in the specified path as as a read-only blockstore,
                  and fronts it with a Filestore whose positional mappings are
                  stored inside the CAR itself.
          - name: Create a File
            behaviors:
              - id: CLIENT_FS_003
                description: Create file and return file name
          - name: Generate input file
            behaviors:
              - id: CLIENT_FS_004
                description: Generate input file
      Node:
        features:
          - name: Read Empty File
            behaviors:
              - id: NODE_CONFIG_001
                description: Config from empty file should be the same as default
          - name: Read Non-existent File
            behaviors:
              - id: NODE_CONFIG_002
                description: Config from not exisiting file should be the same as default
          - name: Default Full Node Config
            behaviors:
              - id: NODE_CONFIG_003
                description: Write config based on default full node
          - name: Default Miner Node Config
            behaviors:
              - id: NODE_CONFIG_004
                description: Write config based on default miner node
          - name: Shutdown Handler
            behaviors:
              - id: NODE_SHUTDOWN_001
                description: Create shutdown handler
          - name: Shutdown Monitor
            behaviors:
              - id: NODE_SHUTDOWN_002
                description: Manages shutdown requests, by watching signals and invoking the
                  supplied handlers in order.
          - name: Median Gas
            behaviors:
              - id: REPO_GAS_001
                description: Finds 55th percentile instead of median to put negative pressure on
                  gas price
          - name: Node Lock
            behaviors:
              - id: REPO_MUT_001
                description: Node should be able to lock once
          - name: Node Already Locked
            behaviors:
              - id: REPO_MUT_002
                description: Already locked nodes should return errors
          - name: Node Unlock
            behaviors:
              - id: REPO_MUT_003
                description: Node should be able to unlock
      Common:
        features:
          - name: Filesystem Based Repo
            behaviors:
              - id: REPO_FS_001
                description: Creates a repository instance based on a path on file system
          - name: Filesystem Repo Initialization
            behaviors:
              - id: REPO_FS_002
                description: Initializes Filesystem based repository
          - name: Memory Based Repo
            behaviors:
              - id: REPO_MEM_001
                description: " Creates new memory based repository with provided options"
      Key Store:
        features:
          - name: Create KeyStore Object
            behaviors:
              - id: REPO_KEYSTR_001
                description: Should be able to create KeyStore object
          - name: List Keys
            behaviors:
              - id: REPO_KEYSTR_002
                description: Should be able to list keys from KeyStore
          - name: Insert Key
            behaviors:
              - id: REPO_KEYSTR_003
                description: Inserts key/value pair into KeyStore
          - name: Key Conflict
            behaviors:
              - id: REPO_KEYSTR_004
                description: Inserting Key that already exists should error out
          - name: Delete Key
            behaviors:
              - id: REPO_KEYSTR_006
                description: Deletes the record from KeyStore given the Key as argument
      Network:
        features:
          - name: Api Endpoint
            behaviors:
              - id: REPO_NET_001
                description: Api endpoint should return multiaddress for communication with
                  Lotus API
          - name: Set Api Endpoint
            behaviors:
              - id: REPO_NET_002
                description: Set the endpoint of the current API so it can be read by API
                  clients
          - name: Api Endpoint with closed repo
            behaviors:
              - id: REPO_NET_003
                description: When node closes, multiaddress should be null
  Virtual Machine:
    subsystems:
      Common:
        features:
          - name: Gas Estimate Cap
            behaviors:
              - id: GAS_ESTIMATE_CAP_001
                description: Given a Message and a known Tipset key, return an estimated gas fee
                  cap for the specified message
          - name: Gas Estimate Limit
            behaviors:
              - id: GAS_ESTIMATE_LIMIT_001
                description: Given a Message and a known Tipset key, return the estimated gas
                  limit for the specified message
              - id: GAS_ESTIMATE_LIMIT_002
                description: Fails if given message fails to execute
          - name: Gas Estimate Premium
            behaviors:
              - id: GAS_ESTIMATE_PREMIUM_001
                description: Given a number of epochs nblocksincl, estimate what gas price
                  should be used for a message to have high likelihood of
                  inclusion in specified number of epochs
      Runtime:
        features:
          - name: Message Call
            behaviors:
              - id: MSG_CALL_001
                description: Succeeds if message struct does not differ in method in an actor's
                  function table
              - id: MSG_CALL_002
                description: "Succeeds if a regular (unsigned) message performs a full round
                  trip (marshal -> unmarshal) "
              - id: MSG_CALL_003
                description: Succeeds if a signed message performs a full round trip (marshal ->
                  unmarshal)
          - name: Message Serialize
            behaviors:
              - id: SERIALIZE_MSG_001
                description: Succeeds if a message's byte serialization does not fail
          - name: Message Serialization
            behaviors:
              - id: SIGNED_MSG_001
                description: Succeeds if JSON marshal and unmarshal succeeds
  Miner:
    subsystems:
      Mining:
        features:
          - name: Miner Create Block
            behaviors:
              - id: MINER_CREATE_BLOCK_001
                description: Given a block template, create a new block and return a full block
                  message signed by the local (miner) node
          - name: Miner Run
            behaviors:
              - id: MINER_RUN_001
                description: Start mining using GPU
              - id: MINER_RUN_002
                description: Given that GPU proving is disabled, start mining without the GPU
          - name: Miner Stop
            behaviors:
              - id: MINER_STOP_001
                description: Stop a running miner
      Common:
        features:
          - name: Miner Get Base Info
            behaviors:
              - id: MINER_GET_BASE_INFO_001
                description: "Given a miner address return the miner power, network power,
                  sectors, worker key, sector size, beacon entries and if the
                  miner is eligible for mining "
          - name: Miner Initialization
            behaviors:
              - id: MINER_INIT_001
                description: Given miner and worker keys, sector size, initialize the miner
                  repository on the local file system
              - id: MINER_INIT_002
                description: Fails if it can't connect to the full node API
              - id: MINER_INIT_003
                description: Fails if the full node API doesn't support API v1
              - id: MINER_INIT_004
                description: Fails if the miner repo was already initialized
              - id: MINER_INIT_005
                description: Given some metadata about presealed sectors, initialize the repo as
                  a genesis miner
          - name: Actor Address
            behaviors:
              - id: ACTOR_ADDRESS_001
                description: Return the actor address for the given miner
      Sectors:
        features:
          - name: Miner Sector Status
            behaviors:
              - id: MINER_SECTOR_STATUS_001
                description: Given a sector number, return the information about the sector
                  specified
          - name: Sector Add Piece to any
            behaviors:
              - id: SECTOR_ADD_PIECE_TO_ANY_001
                description: Given a piece, add it to an open sector. If no sectors with enough
                  space are open, create a new sector
              - id: SECTOR_ADD_PIECE_TO_ANY_002
                description: If a new sector can't be created, wait until more space is
                  available
          - name: Miner Sector List
            behaviors:
              - id: MINER_SECTOR_LIST_001
                description: Return a list of all pledged sectors
          - name: Miner Sectors Summary
            behaviors:
              - id: MINER_SECTORS_SUMMARY
                description: Return summary info of all pledged sectors, grouped by state
          - name: Sectors List in States
            behaviors:
              - id: SECTORS_LIST_IN_STATES_001
                description: Given a list of sector states, return all pledged sectors in
                  specified states
          - name: Sector Start Sealing
            behaviors:
              - id: SECTOR_START_SEALING_001
                description: Given a number of a sector that is either in Empty or WaitDeals
                  state, trigger sealing early
          - name: Sector Set Seal Delay
            behaviors:
              - id: SECTOR_SET_SEAL_DELAY_001
                description: Given a duration, set the time that a newly-created sector waits
                  for more deals before it starts sealing
          - name: Sector Get Seal Delay
            behaviors:
              - id: SECTOR_GET_SEAL_DELAY_002
                description: Return the time that a newly-created sector waits for more deals
                  before it starts sealing
          - name: Sector Set Expected Seal Duration
            behaviors:
              - id: SECTOR_SET_EXPECTED_SEAL_DURATION_001
                description: Given a duration, set the expected time for a sector to seal
          - name: Sector Get Expected Seal Duration
            behaviors:
              - id: SECTOR_GET_EXPECTED_SEAL_DURATION_001
                description: Return the expected time for a sector to seal
          - name: Sector Remove
            behaviors:
              - id: SECTOR_REMOVE_001
                description: Given a sector number, remove the sector from storage, without
                  terminating it on chain
          - name: Sector Terminate
            behaviors:
              - id: SECTOR_TERMINATE_001
                description: Given a sector number, terminate the sector on-chain (add it to a
                  termination batch first), then remove it from storage
          - name: Sector Terminate Pending
            behaviors:
              - id: SECTOR_TERMINATE_PENDING_001
                description: Return a list of sectors pending to be terminated
          - name: Sector CC Upgrade
            behaviors:
              - id: SECTOR_CC_UPGRADE_001
                description: Given a number of a committed capacity sector, mark the specified
                  sector for upgrade. When the next (adequate) regular sector is ProveCommited, terminate the old sector without fees.
              - id: SECTOR_CC_UPGRADE_002
                description: Given a sector that has deals in it, throw an error
              - id: SECTOR_CC_UPGRADE_003
                description: Given a sector that is already marked for upgrade, throw an error
              - id: SECTOR_CC_UPGRADE_004
                description: Given a sector that is not in the "Proving" state, throw an error
              - id: SECTOR_CC_UPGRADE_005
                description: Given a sector is faulty or declared faulted, throw an error
              - id: SECTOR_CC_UPGRADE_006
                description: Don't upgrade if the new sector is not the same size as the CC sector
              - id: SECTOR_CC_UPGRADE_007
                description: Don't upgrade if the new sector's expiry is sooner than the CC sector expiry
              - id: SECTOR_CC_UPGRADE_008
                description: Don't upgrade if the new sector's pledge is < than the CC sector pledge

          - name: Sector Pre Commit Flush
            behaviors:
              - id: SECTOR_PRE_COMMIT_FLUSH_001
                description: Immediately sends a PreCommit message with sectors batched for
                  PreCommit. Returns null if message wasn't sent
          - name: Sector Pre Commit Pending
            behaviors:
              - id: SECTOR_PRE_COMMIT_PENDING_001
                description: Return a list of pending PreCommit sectors to be sent in the next
                  batch message
          - name: Sector Commit Flush
            behaviors:
              - id: SECTOR_COMMIT_FLUSH_001
                description: Immediately sends a Commit message with sectors aggregated for
                  Commit. Returns null if message wasn't sent
          - name: Sector Commit Pending
            behaviors:
              - id: SECTOR_COMMIT_PENDING_001
                description: Returns a list of pending Commit sectors to be sent in the next
                  aggregate message
      Workers:
        features:
          - name: Worker Connect
            behaviors:
              - id: WORKER_CONNECT_001
                description: Connects to all workers RPC
          - name: Worker Stats
            behaviors:
              - id: WORKER_STATS_001
                description: Returns information for worker nodes, grouped by worker ID
          - name: Worker Jobs
            behaviors:
              - id: WORKER_JOBS_001
                description: Return information about active worker jobs, grouped by worker ID
      Storage:
        features:
          - name: Storage Attach
            behaviors:
              - id: STORAGE_ATTACH_001
                description: Given information about external storage, attach it to the local
                  storage index
          - name: Storage Info
            behaviors:
              - id: STORAGE_INFO_001
                description: Given a store ID, return information about attached storage
          - name: Storage Report Health
            behaviors:
              - id: STORAGE_REPORT_HEALTH_001
                description: Given an attached storage ID, return a health report for the
                  specified store
          - name: Storage Declare Sector
            behaviors:
              - id: STORAGE_DECLARE_SECTOR_001
                description: Given an attached storage ID and a sector number, create a sector
                  in the specified store
          - name: Storage Drop Sector
            behaviors:
              - id: STORAGE_DROP_SECTOR_001
                description: Given an attached storage ID and a sector number, delete a sector
                  from the specified store
          - name: Storage Find Sector
            behaviors:
              - id: STORAGE_FIND_SECTOR_001
                description: Given a sector number, return the attached storage ID where the
                  sector is located
          - name: Storage Best Allocate
            behaviors:
              - id: STORAGE_BEST_ALLOC_001
                description: Given a sector type and size, return the list of best (optimal)
                  attached stores for specified sector sorted by available space
          - name: Storage Stat
            behaviors:
              - id: STORAGE_STAT_001
                description: Given an attached storage ID, return statistics (capacity,
                  available, reserved,...) about the specified store
      Storage Deals:
        features:
          - name: Miner Import Deal Data
            behaviors:
              - id: MINER_IMPORT_DEAL_DATA_001
                description: Given a file path, import data about the deal stored in the
                  specified file
  Token:
    subsystems:
      Payment Channels:
        features:
          - name: Payment Channel Allocate Lane
            behaviors:
              - id: PAYCH_ALLOC_001
                description: Succeeds if channel address and lane number are valid
          - name: Payment Channel Best Spendable
            behaviors:
              - id: PAYCH_BEST_001
                description: Returns the best spendable voucher if channel address is valid
          - name: Payment Channel Collect
            behaviors:
              - id: PAYCH_COLLECT_001
                description: Transfers the ToPay amount to the recipient and the remaining
                  change to the sender, if it's called either by the sender or
                  recipient
              - id: PAYCH_COLLECT_002
                description: Fails if not signed by both parties
          - name: Payment Channel Create
            behaviors:
              - id: PAYCH_CREATE_001
                description: Succeeds if sender, recipient and amount are valid
              - id: PAYCH_CREATE_002
                description: Supports both ID and non-ID sender and recipient addresses
              - id: PAYCH_CREATE_003
                description: Fails if sender or recipient addresses are not resolvable to an ID
                  address
          - name: Payment Channel List Vouchers
            behaviors:
              - id: PAYCH_LIST_001
                description: Returns a list of vouchers if channel address is valid
          - name: Payment Channel Settle
            behaviors:
              - id: PAYCH_SETTLE_001
                description: Succeeds if called by either the sender or recipient
              - id: PAYCH_SETTLE_002
                description: Fails if called twice
          - name: Payment Channel Status
            behaviors:
              - id: PAYCH_STATUS_001
                description: Returns  "Channel does not exist" if sender and recipient addresses
                  don't have an open channel
              - id: PAYCH_STATUS_002
                description: Returns channel status, balance and a list of vouchers, if the
                  channel was created
          - name: Voucher Create
            behaviors:
              - id: VOUCH_CREATE_001
                description: Succeeds if the channel address, nonce and amount are valid
              - id: VOUCH_CREATE_002
                description: Fails if voucher address does not match the channel address
              - id: VOUCH_CREATE_003
                description: Fails if creator balance < voucher amount
              - id: VOUCH_CREATE_004
                description: Fails if sum of voucher amounts > channel balance
              - id: VOUCH_CREATE_005
                description: Fails if voucher signature is invalid
              - id: VOUCH_CREATE_006
                description: Fails when signed by channel recipient instead of sender
              - id: VOUCH_CREATE_007
                description: Fails when nonce too low
          - name: Voucher Redeem
            behaviors:
              - id: VOUCH_REDEEM_001
                description: Succeeds, given a valid channel address, voucher and lane
              - id: VOUCH_REDEEM_002
                description: Fails on nonce reuse
              - id: VOUCH_REDEEM_004
                description: Fails if voucher balance < 0
              - id: VOUCH_REDEEM_005
                description: Fails if >12hrs since the channel was settled
              - id: VOUCH_REDEEM_006
                description: Succeds if <12hrs since the channel was settled
              - id: VOUCH_REDEEM_007
                description: Fails if current height < Voucher.TimeLock
              - id: VOUCH_REDEEM_008
                description: Fails if voucher signature is invalid
              - id: VOUCH_REDEEM_009
                description: Fails if current height >= Voucher.TimeLockMax
          - name: Payment Channel Get
            behaviors:
              - id: PAYMENT_CHANNEL_GET_001
                description: Gets channel information. It takes from and to addresses and amount
          - name: Payment Channel Wait Ready
            behaviors:
              - id: PAYMENT_CHANNEL_WAIT_READY_001
                description: waits until the create channel / add funds message with the given
                  message CID arrives
          - name: Payment Channel Available Funds
            behaviors:
              - id: PAYMENT_CHANNEL_AVAILABLE_FUNDS_001
                description: Gets the total available funds currently in the channel, given the
                  address
              - id: PAYMENT_CHANNEL_AVAILABLE_FUNDS_FROM_TO_001
                description: Gets the total available funds in the channel, given the address
                  from and address to
              - id: PAYMENT_CHANNEL_AVAILABLE_FUNDS_FROM_TO_001
                description: If there is no active channel between from / to we still want to
                  return an empty result object
          - name: Payment Channel List
            behaviors:
              - id: PAYMENT_CHANNEL_LIST_001
                description: List channels with given address
          - name: Payment Channel Voucher Valid
            behaviors:
              - id: PAYMENT_CHANNEL_VOUCHER_001
                description: Checks if vaucher is valid in case when voucher amount < balance
              - id: PAYMENT_CHANNEL_VOUCHER_002
                description: Checks if vaucher is valid and fails when funds are too low
              - id: PAYMENT_CHANNEL_VOUCHER_003
                description: Checks if vaucher is valid and fails when signature is invalid
              - id: PAYMENT_CHANNEL_VOUCHER_004
                description: Checks if vaucher is valid and fails when signed by channel To
                  account (instead of From account)
              - id: PAYMENT_CHANNEL_VOUCHER_005
                description: Checks if vaucher is valid and fails when nonce is too low
              - id: PAYMENT_CHANNEL_VOUCHER_006
                description: Checks if vaucher is valid and passes when nonce is higher
              - id: PAYMENT_CHANNEL_VOUCHER_007
                description: Checks if vaucher is valid and passes when nonce for is different
                  lane
              - id: PAYMENT_CHANNEL_VOUCHER_008
                description: Checks if vaucher is valid and fails when voucher has higher nonce
                  but lower value than lane state
              - id: PAYMENT_CHANNEL_VOUCHER_009
                description: Checks if vaucher is valid and passes when voucher total redeemed
                  <= balance
              - id: PAYMENT_CHANNEL_VOUCHER_010
                description: Checks if vaucher is valid and fails when voucher total redeemed >
                  balance
      Wallet:
        features:
          - name: Wallet Balance
            behaviors:
              - id: WALLET_BALANCE_001
                description: Given a known address, returns the balance of the specified address
                  at the current head of the chain
          - name: Wallet Default Address
            behaviors:
              - id: WALLET_DEFAULT_ADDRESS_001
                description: Returns the address marked as default in the wallet
          - name: Wallet Delete
            behaviors:
              - id: WALLET_DELETE_001
                description: Given a (local) address, delete the specified address from the
                  wallet
          - name: Wallet Export
            behaviors:
              - id: WALLET_EXPORT_001
                description: Given a (local) address, return the private key of the specified
                  address
          - name: Wallet Has
            behaviors:
              - id: WALLET_HAS_001
                description: Given an address, return true if the specified address is in the
                  wallet
          - name: Wallet Import
            behaviors:
              - id: WALLET_IMPORT_001
                description: Given a private key, import it to the wallet and return the
                  associated address
          - name: Wallet List
            behaviors:
              - id: WALLET_LIST_001
                description: Return a list of all addresses in the wallet
          - name: Wallet New
            behaviors:
              - id: WALLET_NEW_001
                description: "Creates and returns a new address with the given sigType, one of:
                  bls, secp256k1, secp256k1-ledger"
          - name: Wallet Set Default
            behaviors:
              - id: WALLET_SET_DEFAULT_001
                description: Given a (local) address, mark it as the default
          - name: Wallet Sign
            behaviors:
              - id: WALLET_SIGN_001
                description: Given an (local) address and an array of bytes, return the
                  signature of the specified bytes
          - name: Wallet Sign Message
            behaviors:
              - id: WALLET_SIGN_MESSAGE_001
                description: Given a (local) address and an unsigned message, sign and return a
                  signed message
          - name: Wallet Validate Address
            behaviors:
              - id: WALLET_VALIDATE_ADDRESS_001
                description: Given a string, return the address if it can be decoded
          - name: Wallet Verify
            behaviors:
              - id: WALLET_VERIFY_001
                description: Given (any) address, a signature and some bytes, return true if the
                  signature is valid for the specified address and input bytes
  Network:
    subsystems:
      Common:
        features:
          - name: Net Connectedness
            behaviors:
              - id: NET_CONNECTEDNESS_001
                description: Given a peer ID, return the capacity for a connection with the
                  specified peer
          - name: Net Peers
            behaviors:
              - id: NET_PEERS_001
                description: Return the list of peers connected to the local node
          - name: Net Connect
            behaviors:
              - id: NET_CONNECT_001
                description: Given a peer address, connect to the specified peer
          - name: Net ID
            behaviors:
              - id: NET_ID_001
                description: Returns the peerID of the lib2p2 node backing this Filecoin node
          - name: Net Disconnect
            behaviors:
              - id: NET_DISCONNECT_001
                description: Given a peer ID, disconnect from the specified peer
          - name: Net Find Peer
            behaviors:
              - id: NET_FIND_PEER_001
                description: Given a (known) peer ID, search and return information (with relevant addresses) about the specified peer
              - id: NET_FIND_PEER_002
                description: Given an (unknown) peer ID, return an errNotFound
          - name: Net PubSub Scores
            behaviors:
              - id: NET_PUBSUB_SCORES_001
                description: Return a list of pubsub scores for all peers, sorted lexicographically by ID
  Market:
    subsystems:
      Market:
        features:
          - name: Market Add Balance
            behaviors:
              - id: MARKET_ADD_BALANCE_001
                description: Adds funds to the market actor
          - name: Market Get Reserved
            behaviors:
              - id: MARKET_GET_RESERVED_001
                description: Gets the amount of funds that are currently reserved for the
                  address
          - name: Market Reserve Funds
            behaviors:
              - id: MARKET_RESERVE_FUNDS_001
                description: Reserves funds for a deal
          - name: Market Release Funds
            behaviors:
              - id: MARKET_RELEASE_FUNDS_001
                description: Releases reserved funds
          - name: Market Withdraw
            behaviors:
              - id: IdNotSnakeCase
                description: Withdraws unlocked funds from the market actor
